:root {
    --bg-dark:#0b1d16; --bg-card:#12261f; --bg-header:#0d2019;
    --accent-green:#4ade80; --accent-green-dark:#22c55e;
    --text-light:#e2e8f0; --text-muted:#94a3b8; --outline:rgba(255,255,255,.08);
    --danger:#f87171;
  }
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Segoe UI',Roboto,sans-serif;background:var(--bg-dark);color:var(--text-light);min-height:100vh;display:flex;flex-direction:column}
  .site-header,.site-footer{padding:20px 24px;background:var(--bg-header)}
  .site-header{border-bottom:1px solid var(--outline)}
  .site-footer{border-top:1px solid var(--outline);text-align:center;font-size:.8rem;color:var(--text-muted)}
  
  .brand{display:flex;align-items:center;gap:10px}
  .brand-center{justify-content:center}              /* centered brand */
  .dot{width:12px;height:12px;background:var(--accent-green);border-radius:50%}
  .site-header h1{font-size:1.35rem;text-align:center}
  .tagline{font-size:.9rem;color:var(--text-muted);text-align:center;margin-top:6px}
  
  .container{width:100%;flex:1;padding:16px}
  
  .scope-section{background:var(--bg-card);border:1px solid var(--outline);border-radius:8px;margin-bottom:24px;overflow:hidden}
  .scope-header{background:rgba(255,255,255,.02);padding:12px 16px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--outline)}
  .scope-header h2{font-size:1rem;font-weight:500}
  .scope1 .scope-header h2{color:#86efac}.scope2 .scope-header h2{color:#34d399}.scope3 .scope-header h2{color:#4ade80}
  
  .btn{padding:6px 12px;font-size:.85rem;border:none;border-radius:4px;cursor:pointer;font-weight:500}
  .btn-primary{background:var(--accent-green);color:#000}.btn-primary:hover{background:var(--accent-green-dark)}
  .btn-outline{background:transparent;color:var(--accent-green);border:1px solid var(--accent-green)}.btn-outline:hover{background:var(--accent-green);color:#000}
  
  .table-wrap{width:100%;overflow-x:auto}
  .data-table{width:100%;border-collapse:collapse;font-size:.85rem}
  .data-table th,.data-table td{border-bottom:1px solid var(--outline);padding:8px;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .data-table th{background:rgba(255,255,255,.03);font-weight:500;color:var(--text-muted)}
  /* Column widths */
  .data-table th:nth-child(1),.data-table td:nth-child(1){min-width:120px}   /* Country */
  .data-table th:nth-child(2),.data-table td:nth-child(2){min-width:80px;text-align:center} /* Year */
  .data-table th:nth-child(3),.data-table td:nth-child(3){min-width:160px}   /* Industry */
  .data-table th:nth-child(4),.data-table td:nth-child(4){min-width:150px;white-space:normal} /* Flow Direction (S3) or Activity */
  .data-table th:nth-child(5),.data-table td:nth-child(5){min-width:220px;white-space:normal} /* Category or Activity */
  .data-table th:nth-child(6),.data-table td:nth-child(6){min-width:180px;white-space:normal} /* Type or Quantity */
  .data-table th:nth-child(7),.data-table td:nth-child(7){min-width:200px}   /* Group/Activity */
  .data-table th:nth-child(8),.data-table td:nth-child(8){min-width:200px;white-space:normal} /* Subtype */
  .data-table th:nth-child(9),.data-table td:nth-child(9){min-width:120px}   /* Unit */
  .data-table th:nth-child(10),.data-table td:nth-child(10){min-width:90px}  /* Factor */
  .data-table th:nth-child(11),.data-table td:nth-child(11){min-width:110px} /* Quantity */
  .data-table th:nth-child(12),.data-table td:nth-child(12){min-width:260px;white-space:normal} /* Description */
  .data-table th:last-child,.data-table td:last-child{min-width:90px;text-align:center}
  
  .data-table select,.data-table input,.data-table textarea{width:100%;background:var(--bg-dark);color:var(--text-light);border:1px solid var(--outline);border-radius:4px;padding:4px 6px;font-size:.85rem}
  .data-table select:focus,.data-table input:focus,.data-table textarea:focus{outline:1px solid var(--accent-green);border-color:var(--accent-green)}
  .data-table textarea{resize:vertical;min-height:40px;white-space:normal}
  .delete-row{background:var(--danger);color:#fff;padding:4px 8px;border:none;border-radius:4px}
  .delete-row:hover{background:#dc2626}
  
  .toolbar{display:flex;gap:12px;margin:20px 0}
  
  .cards-grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(180px,1fr))}
  .stat-card{background:var(--bg-card);border:1px solid var(--outline);padding:12px;border-radius:6px;text-align:center}
  .stat-label{font-size:.8rem;color:var(--text-muted);margin-bottom:6px}
  .stat-value{font-size:1.2rem;font-weight:bold;color:var(--accent-green)}
  
  .viz-section{margin-top:8px}
  .viz-section h3{font-size:1rem;color:#a7f3d0;margin:6px 2px 12px;text-align:left}
  .viz-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
  .viz-card{grid-column:span 6;background:var(--bg-card);border:1px solid var(--outline);border-radius:8px;padding:10px}
  .viz-card.wide{grid-column:span 12}
  .viz-card h4{margin:2px 2px 8px;color:#86efac;font-weight:600;font-size:.95rem}
  .viz-card>div{width:100%;height:320px}
  @media(max-width:900px){.viz-card{grid-column:span 12}}
  